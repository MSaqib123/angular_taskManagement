<ul class="task-list space-y-4" dragDrop>
  <li *ngFor="let todo of tasks"
      class="task-card group relative bg-white p-4 rounded-lg shadow-sm border border-gray-200
             flex items-center gap-4
             priority-{{todo.priority}}
             recurrence-{{todo.recurrence}}
             {{todo.isCompleted ? 'completed opacity-70' : ''}}"
      [attr.data-id]="todo.id"
      draggable="true">

    <!-- Left side – checkbox + text (takes only the space it needs) -->
    <div class="flex items-center space-x-3 flex-1 min-w-0"> <!-- flex-1 + min-w-0 fixes shrinking text -->
      <input type="checkbox"
             class="toggle-task h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"
             [checked]="todo.isCompleted"
             (change)="toggle.emit(todo.id)">

      <div class="flex-1 min-w-0"> <!-- allows long text to truncate properly -->
        <h3 class="text-lg font-semibold truncate {{todo.isCompleted ? 'text-gray-500 line-through' : 'text-gray-800'}}">
          {{todo.title}}
        </h3>
        <p class="text-sm text-gray-600 truncate">
          Category: {{todo.category}} | Priority: {{todo.priority}}
          {{todo.dueDate ? '| Due: ' + (todo.dueDate | date:'shortDate') : ''}}
          {{todo.recurrence !== 'none' ? '| Recurrence: ' + todo.recurrence : ''}}
          {{todo.startTime || todo.endTime ? '| Time: ' + formatTime(todo.startTime) + ' - ' + formatTime(todo.endTime) : ''}}
        </p>

        <!-- Recurrence circle + label (inside the card, not ::before pseudo) -->
        <span *ngIf="todo.recurrence !== 'none'"
              class="recurrence-badge inline-flex items-center mt-2 text-xs font-medium">
          <span class="w-2.5 h-2.5 rounded-full mr-1.5"
                [class.bg-blue-500]="todo.recurrence === 'daily'"
                [class.bg-violet-500]="todo.recurrence === 'weekly'"
                [class.bg-pink-500]="todo.recurrence === 'monthly'"></span>
          {{todo.recurrence | titlecase}}
        </span>
      </div>
    </div>

    <!-- Delete button – always stays on the far right, appears on hover (nice effect) -->
    <button class="btn-delete-task opacity-0 group-hover:opacity-100 transition-opacity text-red-500 hover:text-red-700 hover:bg-red-50 p-2 rounded-full"
            (click)="delete.emit(todo.id)">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
      </svg>
    </button>
  </li>
</ul>